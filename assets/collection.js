const loadCollection=async()=>{const e=document.querySelector(".collection-products"),t=e.querySelector(".product-list"),o=document.querySelector(".collection-filters");t&&(t.style.opacity=".2");const n=await fetch(window.location.href),l=await n.text(),c=(new DOMParser).parseFromString(l,"text/html");e?.replaceWith(c.querySelector(".collection-products")),o?.replaceWith(c.querySelector(".collection-filters")),window.dispatchEvent(new CustomEvent("kt.collection.loaded"));const r=document.querySelector(".collection-products"),i=document.querySelector('[id*="__navbar"].sticky-top')?.clientHeight||0;r.style.scrollMarginTop=`${i}px`,r.scrollIntoView()};class CollectionFilters extends HTMLElement{constructor(){super(),this.form=this.querySelector("form"),this.form.querySelectorAll("input").forEach((e=>{e.addEventListener("change",(()=>{const e=new URLSearchParams(new FormData(this.form)),t=`${window.location.pathname}?${e.toString()}`;window.history.replaceState({},"",t),loadCollection()}))})),this.querySelectorAll(".btn-filters-clear-all").forEach((e=>{const t=new URLSearchParams(window.location.search);for(const o of t.keys())o.includes("filter.")&&e.removeAttribute("hidden");e.addEventListener("click",(()=>{for(const e of[...t.keys()])e.includes("filter.")&&t.delete(e);const e=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",e),loadCollection()}))}))}}customElements.define("collection-filters",CollectionFilters);class SortBy extends HTMLElement{constructor(){super(),this.querySelectorAll("input").forEach((e=>{e.addEventListener("change",(()=>{this.setUrl(e.value),loadCollection()}))}))}setUrl(e){const t=new URLSearchParams(window.location.search);t.set("sort_by",e),t.delete("page");const o=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",o)}}customElements.define("sort-by",SortBy);class Pagination extends HTMLElement{constructor(){super(),this.querySelectorAll("a").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),this.setUrl(e.dataset.newPage),loadCollection()}))}))}setUrl(e){const t=new URLSearchParams(window.location.search);t.set("page",e);const o=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",o)}}customElements.define("collection-pagination",Pagination);
